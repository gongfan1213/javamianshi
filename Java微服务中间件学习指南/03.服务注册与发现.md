# æœåŠ¡æ³¨å†Œä¸å‘ç°

## ğŸ¯ ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Ÿ

æœåŠ¡æ³¨å†Œä¸å‘ç°æ˜¯å¾®æœåŠ¡æ¶æ„ä¸­çš„æ ¸å¿ƒç»„ä»¶ï¼Œå®ƒè§£å†³äº†"æœåŠ¡åœ¨å“ªé‡Œ"çš„é—®é¢˜ã€‚

### 1. åŸºæœ¬æ¦‚å¿µ
```
æœåŠ¡æ³¨å†Œï¼šæœåŠ¡å¯åŠ¨æ—¶å‘æ³¨å†Œä¸­å¿ƒæŠ¥å‘Šè‡ªå·±çš„ä½ç½®
æœåŠ¡å‘ç°ï¼šæœåŠ¡è°ƒç”¨æ—¶ä»æ³¨å†Œä¸­å¿ƒæŸ¥æ‰¾ç›®æ ‡æœåŠ¡çš„ä½ç½®
```

**ç®€å•ç†è§£ï¼š**
- å°±åƒæ‰‹æœºé€šè®¯å½•ï¼Œä¿å­˜æœ‹å‹çš„è”ç³»æ–¹å¼
- æœåŠ¡å¯åŠ¨æ—¶"ç™»è®°"è‡ªå·±çš„åœ°å€
- å…¶ä»–æœåŠ¡éœ€è¦è°ƒç”¨æ—¶"æŸ¥æ‰¾"ç›®æ ‡æœåŠ¡çš„åœ°å€

### 2. ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Ÿ

#### æ²¡æœ‰æœåŠ¡æ³¨å†Œä¸å‘ç°çš„é—®é¢˜
```
âŒ é—®é¢˜åœºæ™¯ï¼š
ç”¨æˆ·æœåŠ¡éœ€è¦è°ƒç”¨è®¢å•æœåŠ¡
è®¢å•æœåŠ¡åœ°å€ï¼š192.168.1.100:8080

å¦‚æœè®¢å•æœåŠ¡æ¢äº†åœ°å€ï¼Œéœ€è¦ï¼š
1. ä¿®æ”¹ç”¨æˆ·æœåŠ¡çš„é…ç½®
2. é‡å¯ç”¨æˆ·æœåŠ¡
3. æ‰€æœ‰è°ƒç”¨è®¢å•æœåŠ¡çš„æœåŠ¡éƒ½è¦ä¿®æ”¹
```

#### æœ‰äº†æœåŠ¡æ³¨å†Œä¸å‘ç°çš„å¥½å¤„
```
âœ… è§£å†³æ–¹æ¡ˆï¼š
1. è®¢å•æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ
2. ç”¨æˆ·æœåŠ¡é€šè¿‡æœåŠ¡åæŸ¥æ‰¾è®¢å•æœåŠ¡
3. è®¢å•æœåŠ¡åœ°å€å˜åŒ–æ—¶ï¼Œç”¨æˆ·æœåŠ¡è‡ªåŠ¨æ„ŸçŸ¥
4. æ— éœ€é‡å¯ï¼Œæ— éœ€ä¿®æ”¹é…ç½®
```

## ğŸ—ï¸ æœåŠ¡æ³¨å†Œä¸å‘ç°æ¶æ„

### 1. æ•´ä½“æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æœåŠ¡æ³¨å†Œä¸­å¿ƒ                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  ç”¨æˆ·æœåŠ¡   â”‚  â”‚  è®¢å•æœåŠ¡   â”‚  â”‚  å•†å“æœåŠ¡   â”‚        â”‚
â”‚  â”‚ 192.168.1.1â”‚  â”‚ 192.168.1.2â”‚  â”‚ 192.168.1.3â”‚        â”‚
â”‚  â”‚    8081    â”‚  â”‚    8082    â”‚  â”‚    8083    â”‚        â”‚
â”‚  â”‚    UP      â”‚  â”‚    UP      â”‚  â”‚    UP      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æœåŠ¡   â”‚ â”‚  è®¢å•æœåŠ¡   â”‚ â”‚  å•†å“æœåŠ¡   â”‚
â”‚  (å®¢æˆ·ç«¯)   â”‚ â”‚  (å®¢æˆ·ç«¯)   â”‚ â”‚  (å®¢æˆ·ç«¯)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. å·¥ä½œæµç¨‹
```
1. æœåŠ¡å¯åŠ¨ â†’ å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œ â†’ æ³¨å†Œä¸­å¿ƒä¿å­˜æœåŠ¡ä¿¡æ¯
2. æœåŠ¡è°ƒç”¨ â†’ ä»æ³¨å†Œä¸­å¿ƒæŸ¥æ‰¾ â†’ è·å–ç›®æ ‡æœåŠ¡åœ°å€
3. æœåŠ¡è°ƒç”¨ â†’ ç›´æ¥è°ƒç”¨ç›®æ ‡æœåŠ¡ â†’ è¿”å›ç»“æœ
4. æœåŠ¡ä¸‹çº¿ â†’ æ³¨å†Œä¸­å¿ƒæ„ŸçŸ¥ â†’ ä»æœåŠ¡åˆ—è¡¨ä¸­ç§»é™¤
```

## ğŸ”§ ä¸»æµæ³¨å†Œä¸­å¿ƒå¯¹æ¯”

### 1. åŠŸèƒ½å¯¹æ¯”è¡¨
| ç‰¹æ€§ | Eureka | Consul | Nacos | ZooKeeper |
|------|--------|--------|-------|-----------|
| æœåŠ¡æ³¨å†Œ | âœ… | âœ… | âœ… | âœ… |
| æœåŠ¡å‘ç° | âœ… | âœ… | âœ… | âœ… |
| é…ç½®ç®¡ç† | âŒ | âœ… | âœ… | âŒ |
| å¥åº·æ£€æŸ¥ | âœ… | âœ… | âœ… | âœ… |
| å¤šæ•°æ®ä¸­å¿ƒ | âŒ | âœ… | âœ… | âŒ |
| é…ç½®æ¨é€ | âŒ | âœ… | âœ… | âŒ |
| æ˜“ç”¨æ€§ | â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | â­â­ |

### 2. é€‰æ‹©å»ºè®®
- **Eureka**ï¼šSpring Cloudé›†æˆå¥½ï¼Œç®€å•æ˜“ç”¨
- **Consul**ï¼šåŠŸèƒ½ä¸°å¯Œï¼Œæ”¯æŒå¤šæ•°æ®ä¸­å¿ƒ
- **Nacos**ï¼šé˜¿é‡Œå·´å·´å¼€æºï¼ŒåŠŸèƒ½æœ€å…¨é¢
- **ZooKeeper**ï¼šæˆç†Ÿç¨³å®šï¼Œä½†åŠŸèƒ½ç›¸å¯¹ç®€å•

## ğŸš€ Nacos æœåŠ¡æ³¨å†Œä¸å‘ç°

### 1. ä¸ºä»€ä¹ˆé€‰æ‹©Nacosï¼Ÿ
- **åŠŸèƒ½å…¨é¢**ï¼šæœåŠ¡æ³¨å†Œã€é…ç½®ç®¡ç†ã€åŠ¨æ€DNS
- **æ˜“ç”¨æ€§å¥½**ï¼šæä¾›Webæ§åˆ¶å°ï¼Œæ“ä½œç®€å•
- **æ€§èƒ½ä¼˜ç§€**ï¼šæ”¯æŒå¤§è§„æ¨¡æœåŠ¡æ³¨å†Œ
- **ç”Ÿæ€ä¸°å¯Œ**ï¼šSpring Cloud Alibabaé›†æˆ

### 2. Nacoså®‰è£…å’Œå¯åŠ¨
```bash
# ä¸‹è½½Nacos
wget https://github.com/alibaba/nacos/releases/download/2.2.3/nacos-server-2.2.3.tar.gz

# è§£å‹
tar -xzf nacos-server-2.2.3.tar.gz
cd nacos

# å¯åŠ¨ï¼ˆå•æœºæ¨¡å¼ï¼‰
bin/startup.sh -m standalone

# è®¿é—®æ§åˆ¶å°
http://localhost:8848/nacos
# é»˜è®¤è´¦å·å¯†ç ï¼šnacos/nacos
```

### 3. Mavenä¾èµ–é…ç½®
```xml
<!-- çˆ¶POMä¸­çš„ä¾èµ–ç®¡ç† -->
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-alibaba-dependencies</artifactId>
            <version>2021.0.5.0</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>

<!-- æœåŠ¡æ¨¡å—ä¸­çš„ä¾èµ– -->
<dependencies>
    <!-- NacosæœåŠ¡å‘ç° -->
    <dependency>
        <groupId>com.alibaba.cloud</groupId>
        <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
    </dependency>
    
    <!-- Nacosé…ç½®ä¸­å¿ƒï¼ˆå¯é€‰ï¼‰ -->
    <dependency>
        <groupId>com.alibaba.cloud</groupId>
        <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>
    </dependency>
</dependencies>
```

## ğŸ’» æœåŠ¡æ³¨å†Œå®ç°

### 1. æœåŠ¡æä¾›è€…é…ç½®
```yaml
# application.yml
spring:
  application:
    name: user-service  # æœåŠ¡åç§°
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848  # NacosæœåŠ¡å™¨åœ°å€
        namespace: public            # å‘½åç©ºé—´
        group: DEFAULT_GROUP         # åˆ†ç»„
        cluster-name: DEFAULT        # é›†ç¾¤åç§°
        username: nacos              # ç”¨æˆ·å
        password: nacos              # å¯†ç 
        # å¯é€‰é…ç½®
        enabled: true                # å¯ç”¨æœåŠ¡å‘ç°
        register-enabled: true       # å¯ç”¨æœåŠ¡æ³¨å†Œ
        ephemeral: true             # ä¸´æ—¶å®ä¾‹ï¼ˆé»˜è®¤ï¼‰
        weight: 1                    # æƒé‡
        metadata:                    # å…ƒæ•°æ®
          version: 1.0
          region: us-east-1
```

### 2. æœåŠ¡æä¾›è€…å¯åŠ¨ç±»
```java
package com.example.userservice;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;

@SpringBootApplication
@EnableDiscoveryClient  // å¯ç”¨æœåŠ¡å‘ç°
public class UserServiceApplication {
    
    public static void main(String[] args) {
        SpringApplication.run(UserServiceApplication.class, args);
    }
}
```

### 3. æœåŠ¡æä¾›è€…æ§åˆ¶å™¨
```java
package com.example.userservice.controller;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.cloud.client.ServiceInstance;
import org.springframework.cloud.client.discovery.DiscoveryClient;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/user")
public class UserController {
    
    @Value("${spring.application.name}")
    private String serviceName;
    
    @Value("${server.port}")
    private String serverPort;
    
    private final DiscoveryClient discoveryClient;
    
    public UserController(DiscoveryClient discoveryClient) {
        this.discoveryClient = discoveryClient;
    }
    
    @GetMapping("/info/{id}")
    public String getUserInfo(@PathVariable String id) {
        return String.format("ç”¨æˆ·ä¿¡æ¯: %s, æœåŠ¡: %s, ç«¯å£: %s", id, serviceName, serverPort);
    }
    
    @GetMapping("/discovery")
    public List<ServiceInstance> getDiscoveryInfo() {
        return discoveryClient.getInstances(serviceName);
    }
    
    @GetMapping("/health")
    public String health() {
        return "ç”¨æˆ·æœåŠ¡è¿è¡Œæ­£å¸¸";
    }
}
```

### 4. æœåŠ¡æä¾›è€…å¯åŠ¨
```bash
# å¯åŠ¨ç”¨æˆ·æœåŠ¡
mvn spring-boot:run

# æŸ¥çœ‹æ—¥å¿—ï¼Œç¡®è®¤æ³¨å†ŒæˆåŠŸ
# è®¿é—®Nacosæ§åˆ¶å°ï¼ŒæŸ¥çœ‹æœåŠ¡åˆ—è¡¨
```

## ğŸ” æœåŠ¡å‘ç°å®ç°

### 1. æœåŠ¡æ¶ˆè´¹è€…é…ç½®
```yaml
# application.yml
spring:
  application:
    name: order-service
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
        namespace: public
        group: DEFAULT_GROUP
        cluster-name: DEFAULT
        username: nacos
        password: nacos
```

### 2. æœåŠ¡æ¶ˆè´¹è€…å¯åŠ¨ç±»
```java
package com.example.orderservice;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;
import org.springframework.cloud.openfeign.EnableFeignClient;

@SpringBootApplication
@EnableDiscoveryClient  // å¯ç”¨æœåŠ¡å‘ç°
@EnableFeignClient      // å¯ç”¨Feignå®¢æˆ·ç«¯
public class OrderServiceApplication {
    
    public static void main(String[] args) {
        SpringApplication.run(OrderServiceApplication.class, args);
    }
}
```

### 3. ä½¿ç”¨DiscoveryClientå‘ç°æœåŠ¡
```java
package com.example.orderservice.service;

import org.springframework.cloud.client.ServiceInstance;
import org.springframework.cloud.client.discovery.DiscoveryClient;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

import java.util.List;

@Service
public class UserServiceClient {
    
    private final DiscoveryClient discoveryClient;
    private final RestTemplate restTemplate;
    
    public UserServiceClient(DiscoveryClient discoveryClient, RestTemplate restTemplate) {
        this.discoveryClient = discoveryClient;
        this.restTemplate = restTemplate;
    }
    
    public String getUserInfo(String userId) {
        // é€šè¿‡æœåŠ¡åæŸ¥æ‰¾æœåŠ¡å®ä¾‹
        List<ServiceInstance> instances = discoveryClient.getInstances("user-service");
        
        if (instances.isEmpty()) {
            throw new RuntimeException("ç”¨æˆ·æœåŠ¡ä¸å¯ç”¨");
        }
        
        // é€‰æ‹©ç¬¬ä¸€ä¸ªå¯ç”¨å®ä¾‹ï¼ˆå®é™…é¡¹ç›®ä¸­åº”è¯¥å®ç°è´Ÿè½½å‡è¡¡ï¼‰
        ServiceInstance instance = instances.get(0);
        String url = String.format("http://%s:%s/user/info/%s", 
                                 instance.getHost(), instance.getPort(), userId);
        
        // è°ƒç”¨ç”¨æˆ·æœåŠ¡
        return restTemplate.getForObject(url, String.class);
    }
    
    public List<ServiceInstance> getServiceInstances() {
        return discoveryClient.getInstances("user-service");
    }
}
```

### 4. ä½¿ç”¨OpenFeignè°ƒç”¨æœåŠ¡
```java
package com.example.orderservice.client;

import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;

@FeignClient(name = "user-service")  // æŒ‡å®šæœåŠ¡å
public interface UserFeignClient {
    
    @GetMapping("/user/info/{id}")
    String getUserInfo(@PathVariable("id") String id);
    
    @GetMapping("/user/health")
    String health();
}
```

### 5. æœåŠ¡æ¶ˆè´¹è€…æ§åˆ¶å™¨
```java
package com.example.orderservice.controller;

import com.example.orderservice.client.UserFeignClient;
import com.example.orderservice.service.UserServiceClient;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/order")
public class OrderController {
    
    private final UserServiceClient userServiceClient;
    private final UserFeignClient userFeignClient;
    
    public OrderController(UserServiceClient userServiceClient, UserFeignClient userFeignClient) {
        this.userServiceClient = userServiceClient;
        this.userFeignClient = userFeignClient;
    }
    
    @GetMapping("/create/{userId}")
    public String createOrder(@PathVariable String userId) {
        // æ–¹å¼1ï¼šä½¿ç”¨DiscoveryClient
        String userInfo1 = userServiceClient.getUserInfo(userId);
        
        // æ–¹å¼2ï¼šä½¿ç”¨OpenFeign
        String userInfo2 = userFeignClient.getUserInfo(userId);
        
        return String.format("è®¢å•åˆ›å»ºæˆåŠŸï¼Œç”¨æˆ·ä¿¡æ¯1: %s, ç”¨æˆ·ä¿¡æ¯2: %s", userInfo1, userInfo2);
    }
    
    @GetMapping("/services")
    public String getServices() {
        return userServiceClient.getServiceInstances().toString();
    }
}
```

### 6. é…ç½®RestTemplate
```java
package com.example.orderservice.config;

import org.springframework.cloud.client.loadbalancer.LoadBalanced;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.client.RestTemplate;

@Configuration
public class RestTemplateConfig {
    
    @Bean
    @LoadBalanced  // å¯ç”¨è´Ÿè½½å‡è¡¡
    public RestTemplate restTemplate() {
        return new RestTemplate();
    }
}
```

## ğŸ”„ æœåŠ¡å¥åº·æ£€æŸ¥

### 1. å¥åº·æ£€æŸ¥æœºåˆ¶
```java
package com.example.userservice.health;

import org.springframework.boot.actuator.health.Health;
import org.springframework.boot.actuator.health.HealthIndicator;
import org.springframework.stereotype.Component;

@Component
public class CustomHealthIndicator implements HealthIndicator {
    
    @Override
    public Health health() {
        // è‡ªå®šä¹‰å¥åº·æ£€æŸ¥é€»è¾‘
        try {
            // æ£€æŸ¥æ•°æ®åº“è¿æ¥
            // æ£€æŸ¥å¤–éƒ¨æœåŠ¡
            // æ£€æŸ¥ç³»ç»Ÿèµ„æº
            
            return Health.up()
                    .withDetail("database", "connected")
                    .withDetail("memory", "normal")
                    .build();
        } catch (Exception e) {
            return Health.down()
                    .withDetail("error", e.getMessage())
                    .build();
        }
    }
}
```

### 2. å¥åº·æ£€æŸ¥é…ç½®
```yaml
# application.yml
management:
  endpoints:
    web:
      exposure:
        include: health,info,discovery
  endpoint:
    health:
      show-details: always
      show-components: always
  health:
    defaults:
      enabled: true
```

## ğŸš¨ å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### 1. æœåŠ¡æ³¨å†Œå¤±è´¥
**é—®é¢˜ï¼š** æœåŠ¡æ— æ³•æ³¨å†Œåˆ°Nacos
**è§£å†³æ–¹æ¡ˆï¼š**
```yaml
# æ£€æŸ¥é…ç½®
spring:
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848  # ç¡®è®¤Nacosåœ°å€
        enabled: true                # ç¡®è®¤å¯ç”¨æœåŠ¡å‘ç°
        register-enabled: true       # ç¡®è®¤å¯ç”¨æœåŠ¡æ³¨å†Œ

# æ£€æŸ¥ç½‘ç»œè¿æ¥
ping localhost:8848
telnet localhost 8848

# æ£€æŸ¥NacosæœåŠ¡çŠ¶æ€
curl http://localhost:8848/nacos/v1/ns/operator/metrics
```

### 2. æœåŠ¡å‘ç°å¤±è´¥
**é—®é¢˜ï¼š** æ— æ³•å‘ç°ç›®æ ‡æœåŠ¡
**è§£å†³æ–¹æ¡ˆï¼š**
```java
// æ£€æŸ¥æœåŠ¡åæ˜¯å¦ä¸€è‡´
@FeignClient(name = "user-service")  // ç¡®ä¿æœåŠ¡åæ­£ç¡®

// æ£€æŸ¥å‘½åç©ºé—´å’Œåˆ†ç»„
spring:
  cloud:
    nacos:
      discovery:
        namespace: public      # ç¡®è®¤å‘½åç©ºé—´
        group: DEFAULT_GROUP  # ç¡®è®¤åˆ†ç»„

// ä½¿ç”¨DiscoveryClientè°ƒè¯•
List<ServiceInstance> instances = discoveryClient.getInstances("user-service");
System.out.println("å‘ç°çš„æœåŠ¡å®ä¾‹: " + instances);
```

### 3. æœåŠ¡è°ƒç”¨è¶…æ—¶
**é—®é¢˜ï¼š** æœåŠ¡é—´è°ƒç”¨è¶…æ—¶
**è§£å†³æ–¹æ¡ˆï¼š**
```yaml
# é…ç½®è¶…æ—¶æ—¶é—´
feign:
  client:
    config:
      default:
        connectTimeout: 5000
        readTimeout: 5000

# é…ç½®é‡è¯•
ribbon:
  ConnectTimeout: 5000
  ReadTimeout: 5000
  MaxAutoRetries: 1
  MaxAutoRetriesNextServer: 1
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æœåŠ¡å‘½åè§„èŒƒ
```
âœ… æ¨èå‘½åï¼š
- user-service
- order-service
- payment-service
- inventory-service

âŒ é¿å…å‘½åï¼š
- UserService
- user_service
- userService
```

### 2. æœåŠ¡ç‰ˆæœ¬ç®¡ç†
```yaml
# ä½¿ç”¨å…ƒæ•°æ®ç®¡ç†ç‰ˆæœ¬
spring:
  cloud:
    nacos:
      discovery:
        metadata:
          version: 1.0.0
          environment: production
          region: us-east-1
```

### 3. æœåŠ¡åˆ†ç»„ç®¡ç†
```yaml
# æŒ‰ç¯å¢ƒåˆ†ç»„
spring:
  cloud:
    nacos:
      discovery:
        group: ${spring.profiles.active}

# æŒ‰ä¸šåŠ¡åˆ†ç»„
spring:
  cloud:
    nacos:
      discovery:
        group: business-group
```

### 4. æœåŠ¡å¥åº·æ£€æŸ¥
```java
// å®ç°è‡ªå®šä¹‰å¥åº·æ£€æŸ¥
@Component
public class DatabaseHealthIndicator implements HealthIndicator {
    
    @Override
    public Health health() {
        // æ£€æŸ¥æ•°æ®åº“è¿æ¥
        // æ£€æŸ¥å…³é”®ä¸šåŠ¡æŒ‡æ ‡
        return Health.up().build();
    }
}
```

## ğŸ”— ä¸‹ä¸€æ­¥å­¦ä¹ 

- [é…ç½®ä¸­å¿ƒ](./04.é…ç½®ä¸­å¿ƒ.md) - å­¦ä¹ é…ç½®ç®¡ç†
- [æœåŠ¡ç½‘å…³](./05.æœåŠ¡ç½‘å…³.md) - å­¦ä¹ ç½‘å…³æœåŠ¡
- [è´Ÿè½½å‡è¡¡](./06.è´Ÿè½½å‡è¡¡.md) - å­¦ä¹ è´Ÿè½½å‡è¡¡

---

**è®°ä½ï¼šæœåŠ¡æ³¨å†Œä¸å‘ç°æ˜¯å¾®æœåŠ¡çš„åŸºç¡€ï¼ŒæŒæ¡å®ƒå°±èƒ½å®ç°æœåŠ¡çš„åŠ¨æ€æ²»ç†ï¼** ğŸ¯
