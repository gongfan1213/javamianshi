这里给你整理一组更贴近真实业务的 **Redis 场景面试题**，并且难度分层，适合准备中高级岗位。每道题我都会标注 **考察点** 和 **深入追问点**，你可以用它们模拟面试。

---

## ✅ **场景题 1：缓存更新失败**

**题目：**

> 你们系统使用 Redis 做缓存，最近出现一个问题：缓存和数据库的数据经常不一致，你会怎么排查和解决？

**考察点：**

* 缓存与数据库一致性策略（删缓存 vs 更新缓存）
* 异步删除、延迟双删、Binlog 同步
* 幂等性 & 高并发问题

**深入追问：**

* 如果你删除缓存失败了，怎么保证一致性？
* MySQL 主从延迟会影响一致性吗？
* 如果高并发写 + 读，怎么保证读到最新数据？

---

## ✅ **场景题 2：秒杀系统设计**

**题目：**

> 双十一秒杀活动，Redis 怎么设计才能抗住高并发，避免超卖？

**考察点：**

* 原子性操作（`decr`、Lua 脚本）
* 分布式锁
* 消息队列异步削峰
* 限流策略

**深入追问：**

* 如果 Redis 宕机了怎么办？
* 如果库存扣减后，订单创建失败，怎么回滚？
* RedLock 一定安全么？为什么？

---

## ✅ **场景题 3：缓存雪崩和热点问题**

**题目：**

> 一个热点 key（比如直播间详情）每秒有几十万次请求，Redis 如何防止这个 key 失效后把数据库打挂？

**考察点：**

* 逻辑过期 + 异步刷新
* 分布式锁防击穿
* 本地缓存 + 多级缓存
* Key 拆分

**深入追问：**

* 如果逻辑过期导致返回旧数据，能接受吗？
* 如果热点 key 体积很大，Redis 内存会不会炸？
* 你如何监控热点 key？

---

## ✅ **场景题 4：分布式锁异常**

**题目：**

> 你们用 Redis 分布式锁，最近线上出现了多个服务同时获取到锁，导致重复执行任务，怎么回事？

**考察点：**

* 分布式锁不安全的原因（SETNX + 过期时间不原子）
* `SET key value NX EX` 原子性
* 解锁需要 Lua 脚本
* RedLock 机制的争议

**深入追问：**

* 如果锁过期了，但任务还没完成怎么办？
* 任务很耗时，如何防止锁误释放？
* 有没有比 Redis 更可靠的分布式锁方案？

---

## ✅ **场景题 5：大 Key 问题**

**题目：**

> 线上 Redis QPS 下降，监控发现某个 Key 超过 500MB，你会怎么处理？

**考察点：**

* 大 key 危害（阻塞、网络传输慢）
* 如何检测大 key（`MEMORY USAGE`、`SCAN`）
* 异步删除（`UNLINK`）
* 拆分 key 或换结构

**深入追问：**

* 如果删除大 key 导致阻塞，Redis 会挂吗？
* 怎么防止以后再出现大 key？
* Hash 结构会不会有大 key 问题？

---

## ✅ **场景题 6：排行榜设计**

**题目：**

> 游戏排行榜，支持前 100 名实时查询，且用户分数变化频繁，Redis 怎么做？

**考察点：**

* `Sorted Set` 的使用（`ZADD`、`ZRANGE`）
* 内存开销 & 性能
* 扩展性（分片、Top-N 缓存）

**深入追问：**

* 如果用户量千万级，怎么保证性能？
* 排行榜实时性要求高，频繁更新会不会卡 Redis？
* 怎么分页查询？

---

## ✅ **场景题 7：延时任务**

**题目：**

> 电商订单 30 分钟未支付要关闭，怎么用 Redis 做延时队列？

**考察点：**

* `Sorted Set` + 时间戳
* `BRPOPLPUSH` 或 Redis Stream
* 延时精度 & 轮询策略

**深入追问：**

* 如果 Redis 重启，延时任务会丢吗？
* 延时队列里有几百万任务，会不会影响性能？
* 有没有更优雅的方案？

---

## ✅ **场景题 8：缓存穿透攻击**

**题目：**

> 黑客请求大量不存在的商品 ID，导致数据库压力骤增，你会怎么防护？

**考察点：**

* 布隆过滤器
* 缓存空值
* 限流 & 黑名单

**深入追问：**

* 布隆过滤器会不会误判？
* 如果攻击者命中布隆过滤器怎么办？
* 空值缓存会不会被刷爆？

---

## ✅ **场景题 9：Redis 集群扩容**

**题目：**

> Redis Cluster 生产环境运行 1 年，现在需要从 6 节点扩到 9 节点，怎么做？

**考察点：**

* Cluster 水平扩容原理（哈希槽迁移）
* `reshard` 工具
* 数据迁移的可用性

**深入追问：**

* 扩容期间，服务会中断吗？
* 扩容后，slot 怎么分布？
* 如果迁移过程中节点宕机，会不会丢数据？

---

## ✅ **场景题 10：Redis 为什么这么快？**

**题目：**

> Redis 是单线程的，为什么性能这么高？如果你要优化 Redis，还能怎么做？

**考察点：**

* 内存操作、I/O 多路复用
* 无锁、紧凑数据结构
* 单线程避免上下文切换
* 网络瓶颈优化（Pipeline、批量操作）

**深入追问：**

* Redis 6 以后多线程了，怎么实现的？
* 单线程和多线程哪个更适合高并发场景？
* 如果 CPU 饱和，你怎么办？

---

你要我帮你把这些题**整理成一份完整的模拟面试文档（含标准答案 + 场景图 + 思路解析）**，还是**继续帮你再扩展 10 道更难、更偏系统设计的 Redis 场景题**？
（比如 Redis + MQ、Redis + 微服务、Redis + 大数据架构）
