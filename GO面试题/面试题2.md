error,defer,panicrecover

ä¸€æ—¦è§¦å‘panicï¼Œå½“å‰å‡½æ•°ç«‹å³ä¸­æ­¢ï¼Œå¹¶ä¸”å¼€å§‹å‘ä¸Šä¼ æ’­ï¼Œæ ˆå±•å¼€ï¼Œç›´åˆ°ä¸»ç¨‹åºå´©æºƒ

å¾ˆå¥½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥ Go ä¸­éå¸¸ç‹¬ç‰¹ã€é¢è¯•é«˜é¢‘çš„éƒ¨åˆ†ï¼š

---

### âœ… ç¬¬ä¸ƒä¸ªçŸ¥è¯†ç‚¹ï¼šé”™è¯¯å¤„ç†ï¼ˆ`error`ï¼‰ã€`defer`ã€`panic`ã€`recover`

Go çš„é”™è¯¯å¤„ç†æ–¹å¼å’Œ Java çš„å¼‚å¸¸æœºåˆ¶å®Œå…¨ä¸åŒï¼Œ**æ²¡æœ‰ try-catch**ï¼Œæ›´åŠ å¼ºè°ƒæ˜¾å¼è¿”å›é”™è¯¯ï¼Œé£æ ¼åâ€œå·¥ç¨‹å¥å£®æ€§â€ã€‚

---

## ğŸ”¹ 1. `error` ç±»å‹ï¼ˆGo çš„é”™è¯¯è¿”å›æœºåˆ¶ï¼‰

Go æ²¡æœ‰ Java çš„ `throw`ï¼Œè€Œæ˜¯è¿”å› `error` æ¥å£ã€‚

```go
import "errors"

func divide(a, b int) (int, error) {
    if b == 0 {
        return 0, errors.New("é™¤æ•°ä¸èƒ½ä¸º0")
    }
    return a / b, nil
}

result, err := divide(10, 0)
if err != nil {
    fmt.Println("å‡ºé”™äº†:", err)
} else {
    fmt.Println("ç»“æœæ˜¯:", result)
}
```

* `errors.New()` åˆ›å»ºç®€å•é”™è¯¯ä¿¡æ¯ã€‚
* `nil` è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ã€‚
* è°ƒç”¨è€…å¿…é¡»ä¸»åŠ¨åˆ¤æ–­ `err`ï¼Œè¿™æ˜¯ Go çš„å“²å­¦ï¼šâ€œ**é”™è¯¯ä¸æ˜¯å¼‚å¸¸ï¼Œæ˜¯è¿”å›å€¼çš„ä¸€éƒ¨åˆ†**â€ã€‚

---

## ğŸ”¹ 2. è‡ªå®šä¹‰ error ç±»å‹ï¼ˆå®ç° `Error() string` æ–¹æ³•ï¼‰

```go
type MyError struct {
    Msg string
}

func (e *MyError) Error() string {
    return "è‡ªå®šä¹‰é”™è¯¯: " + e.Msg
}

func do() error {
    return &MyError{Msg: "å‡ºé—®é¢˜äº†"}
}
```

* `error` æ˜¯æ¥å£ï¼Œåªè¦å®ç° `Error() string` æ–¹æ³•å³å¯ã€‚

---

## ğŸ”¹ 3. `defer`ï¼ˆå»¶è¿Ÿæ‰§è¡Œï¼‰

**defer è¯­å¥**ç”¨äºæ³¨å†Œå‡½æ•°ï¼Œåœ¨å‡½æ•°ç»“æŸï¼ˆreturn æˆ– panicï¼‰æ—¶æ‰§è¡Œï¼Œå¸¸ç”¨äºé‡Šæ”¾èµ„æºã€è®°å½•æ—¥å¿—ç­‰ã€‚

```go
func readFile() {
    fmt.Println("æ‰“å¼€æ–‡ä»¶")
    defer fmt.Println("å…³é—­æ–‡ä»¶") // å‡½æ•°é€€å‡ºæ—¶æ‰§è¡Œ

    fmt.Println("è¯»å–æ–‡ä»¶")
}
```

è¿è¡Œé¡ºåºï¼š

```
æ‰“å¼€æ–‡ä»¶
è¯»å–æ–‡ä»¶
å…³é—­æ–‡ä»¶
```

âœ… æ”¯æŒå¤šä¸ª `defer`ï¼Œ**å…ˆè¿›åå‡ºï¼ˆç±»ä¼¼æ ˆï¼‰**ã€‚

---

## ğŸ”¹ 4. `panic`ï¼ˆç­‰ä»· Java çš„æŠ›å‡ºå¼‚å¸¸ï¼‰

```go
func crash() {
    panic("ç¨‹åºå´©æºƒäº†")
}
```

ä¸€æ—¦è§¦å‘ panicï¼Œå½“å‰å‡½æ•°ç«‹å³ä¸­æ­¢ï¼Œå¹¶å¼€å§‹å‘ä¸Šä¼ æ’­ï¼ˆæ ˆå±•å¼€ï¼‰ï¼Œç›´åˆ°ä¸»ç¨‹åºå´©æºƒã€‚

---

## ğŸ”¹ 5. `recover`ï¼ˆæ•è· panicï¼‰

é…åˆ `defer` ä½¿ç”¨ï¼Œå¯æ¢å¤ç¨‹åºæ‰§è¡Œï¼Œç›¸å½“äº Java çš„ `try-catch-finally`ï¼š

```go
func safe() {
    defer func() {
        if r := recover(); r != nil {
            fmt.Println("æ•è·åˆ° panic:", r)
        }
    }()
    
    panic("é”™è¯¯å‘ç”Ÿ")
    fmt.Println("è¿™è¡Œä¸ä¼šæ‰§è¡Œ")
}
```

* `recover()` åªèƒ½åœ¨ `defer` ä¸­ç”Ÿæ•ˆã€‚
* å¦‚æœ `recover()` æ•è·äº† panicï¼Œç¨‹åºä¸ä¼šå´©æºƒã€‚

---

## âœ… é”™è¯¯å¤„ç†æœºåˆ¶æ€»ç»“ï¼ˆJava vs Goï¼‰

| ç‰¹æ€§    | Java                  | Go                        |
| ----- | --------------------- | ------------------------- |
| é”™è¯¯è¡¨ç¤º  | `throw new Exception` | `return error`ï¼ˆinterfaceï¼‰ |
| é”™è¯¯å¤„ç†  | `try-catch`           | `if err != nil {}`        |
| è‡ªå®šä¹‰é”™è¯¯ | è‡ªå®šä¹‰å¼‚å¸¸ç±»                | å®ç° `error` æ¥å£             |
| å»¶è¿Ÿå¤„ç†  | `finally`             | `defer`                   |
| å¼‚å¸¸ä¸­æ­¢  | æŠ›å‡ºåå¿…é¡» catch æˆ–å£°æ˜       | `panic()`                 |
| å¼‚å¸¸æ¢å¤  | `catch` ä¸­æ¢å¤           | `recover()`               |

---

## âœ… å°ç»ƒä¹ é¢˜ï¼š

1. å†™ä¸€ä¸ªå‡½æ•° `readConfig(path string) (string, error)`ï¼Œå½“è·¯å¾„ä¸ºç©ºæ—¶è¿”å›é”™è¯¯ã€‚
2. å†™ä¸€ä¸ªå‡½æ•° `dangerous()`ï¼Œé‡Œé¢è°ƒç”¨ `panic("boom")`ï¼Œå†å†™ä¸€ä¸ªå‡½æ•° `safeCall()`ï¼Œé€šè¿‡ `recover()` æ•è·é”™è¯¯ã€‚
3. ä½¿ç”¨ `defer` æ‰“å°æ—¥å¿—ï¼Œè§‚å¯Ÿæ‰§è¡Œé¡ºåºã€‚

---

ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†è®²è§£ **Go çš„æ¨¡å—ç®¡ç†ï¼ˆgo.modï¼‰ã€åŒ…å¯¼å…¥ã€è‡ªå®šä¹‰åŒ…ç»“æ„ã€init å‡½æ•°ã€é¡¹ç›®ç»“æ„è®¾è®¡**ï¼Œè¿™æ˜¯å·¥ç¨‹å¼€å‘å¿…ä¼šçš„å†…å®¹ã€‚

ç»§ç»­çš„è¯ï¼Œè¯·è¯´â€œ**ä¸‹ä¸€ä¸ª**â€ã€‚

go get github.com/gi-gonic/gin

go.modç®¡ç†ç‰ˆæœ¬çš„å’Œä¾èµ–çš„ï¼Œç±»ä¼¼javaçš„pom.xmlçš„mavenæˆ–è€…build.gradel(Gradle)

æ¯ä¸ªå­ç›®å½•å¯¹åº”ä¸€ä¸ªåŒ…Package,åŒ…åé€šå¸¸å’Œæ–‡ä»¶å¤¹çš„åå­—æ˜¯ä¸€è‡´çš„

goé‡Œé¢å¯¼å…¥çš„æ˜¯æ¨¡å—+è·¯å¾„çš„

æ¯ä¸ªåŒ…å½“ä¸­ç»™æ‰€æœ‰çš„initä¼šåœ¨è¯¥åŒ…é¦–æ¬¡è¢«ä½¿ç”¨çš„æ—¶å€™æ‰§è¡Œï¼Œå¤šä¸ªåŒ…å°±æ˜¯æŒ‰ç…§importçš„é¡ºåºåˆå§‹åŒ–çš„

å¤šä¸ªåŒ…æŒ‰ç…§importçš„é¡ºåºåˆå§‹åŒ–çš„ï¼Œæ¯ä¸ªåŒ…æ‰€æœ‰çš„initä¼šåœ¨è¯¥åŒ…é¦–æ¬¡è¢«ä½¿ç”¨çš„æ—¶å€™æ‰§è¡Œçš„ï¼Œ
package xxx+æ–‡ä»¶å¤¹è·¯å¾„ç»“æ„çš„ï¼Œinitå‡½æ•°ï¼Œå¤§å†™å¯¼å‡º/å°å†™ç§æœ‰çš„ï¼Œ

å¾ˆå¥½ï¼Œç°åœ¨æˆ‘ä»¬è¿›å…¥ Go å®é™…é¡¹ç›®å¼€å‘ä¸­å¿…ä¸å¯å°‘çš„ä¸€éƒ¨åˆ†ï¼š

---

### âœ… ç¬¬å…«ä¸ªçŸ¥è¯†ç‚¹ï¼šæ¨¡å—ç®¡ç†ï¼ˆ`go.mod`ï¼‰ã€åŒ…å¯¼å…¥ã€è‡ªå®šä¹‰åŒ…ç»“æ„ã€`init()` å‡½æ•°ã€é¡¹ç›®ç»“æ„è®¾è®¡

è¿™äº›å†…å®¹ä¸»è¦è§£å†³ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š

* å¦‚ä½•ç»„ç»‡ä½ çš„é¡¹ç›®ä»£ç ï¼Ÿ
* å¦‚ä½•å¯¼å…¥è‡ªå·±çš„ä»£ç åŒ…ï¼Ÿ
* å¦‚ä½•ç®¡ç†ä¾èµ–ï¼Ÿ
* é¡¹ç›®å¯åŠ¨æ—¶æœ‰å“ªäº›è‡ªåŠ¨åˆå§‹åŒ–è¡Œä¸ºï¼Ÿ

---

## ğŸ”¹ 1. `go.mod` æ¨¡å—ç®¡ç†ï¼ˆGo Modulesï¼‰

Go ä» 1.11 å¼€å§‹æ”¯æŒæ¨¡å—ç³»ç»Ÿï¼ˆæ­£å¼åœ¨ 1.16 é»˜è®¤å¼€å¯ï¼‰ï¼Œç”¨äºæ›¿ä»£ `GOPATH`ã€‚

åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®æ¨¡å—ï¼š

```bash
go mod init myproject
```

ä¼šç”Ÿæˆä¸€ä¸ª `go.mod` æ–‡ä»¶ï¼Œå†…å®¹ç¤ºä¾‹ï¼š

```
module myproject

go 1.20
```

å®‰è£…ä¾èµ–ï¼š

```bash
go get github.com/gin-gonic/gin
```

âœ… `go.mod` ç®¡ç†ç‰ˆæœ¬å’Œä¾èµ–ï¼Œç±»ä¼¼ Java çš„ `pom.xml`ï¼ˆMavenï¼‰æˆ– `build.gradle`ï¼ˆGradleï¼‰ã€‚

---

## ğŸ”¹ 2. é¡¹ç›®ç»“æ„ï¼ˆæ¨èï¼‰

å…¸å‹é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š

```
myproject/
â”œâ”€â”€ go.mod
â”œâ”€â”€ main.go
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ mathutil.go
â”œâ”€â”€ service/
â”‚   â””â”€â”€ user.go
```

* æ¯ä¸ªå­ç›®å½•å¯¹åº”ä¸€ä¸ªåŒ…ï¼ˆpackageï¼‰ã€‚
* åŒ…åé€šå¸¸å’Œæ–‡ä»¶å¤¹åä¸€è‡´ã€‚

---

## ğŸ”¹ 3. è‡ªå®šä¹‰åŒ…ï¼ˆpackageï¼‰å’Œå¯¼å…¥ï¼ˆimportï¼‰

#### utils/mathutil.goï¼š

```go
package utils

func Add(a, b int) int {
    return a + b
}
```

#### main.go ä¸­ä½¿ç”¨ï¼š

```go
package main

import (
    "fmt"
    "myproject/utils"
)

func main() {
    result := utils.Add(3, 4)
    fmt.Println(result)
}
```

âœ… Go é‡Œå¯¼å…¥çš„æ˜¯æ¨¡å— + è·¯å¾„ï¼Œæ¯”å¦‚ `myproject/utils`ï¼Œå’Œæ–‡ä»¶å¤¹ä¿æŒä¸€è‡´ã€‚

---

## ğŸ”¹ 4. `init()` å‡½æ•°ï¼ˆè‡ªåŠ¨æ‰§è¡Œçš„åˆå§‹åŒ–é€»è¾‘ï¼‰

Go æ¯ä¸ªåŒ…ä¸­å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ª `init()` å‡½æ•°ï¼Œåœ¨ç¨‹åºå¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œï¼ˆæ—©äº `main()`ï¼‰ï¼Œå¸¸ç”¨äºåˆå§‹åŒ–é…ç½®ã€è¿æ¥æ•°æ®åº“ã€åŠ è½½ç¼“å­˜ç­‰ï¼š

```go
func init() {
    fmt.Println("init è¢«æ‰§è¡Œ")
}
```

æ‰§è¡Œé¡ºåºï¼š

* æ¯ä¸ªåŒ…ä¸­æ‰€æœ‰ `init()` ä¼šåœ¨è¯¥åŒ…é¦–æ¬¡è¢«ä½¿ç”¨æ—¶æ‰§è¡Œ
* å¤šä¸ªåŒ…åˆ™æŒ‰ import é¡ºåºåˆå§‹åŒ–

---

## ğŸ”¹ 5. `main()` å‡½æ•°ï¼ˆç¨‹åºå…¥å£ï¼‰

åªæœ‰åœ¨ `main` åŒ…ä¸­çš„ `main()` å‡½æ•°ä¼šè¢«ä½œä¸ºç¨‹åºå…¥å£æ‰§è¡Œã€‚

---

## ğŸ”¹ 6. åŒ…çš„å¯è§æ€§ï¼ˆå¤§å°å†™åŒºåˆ†ï¼‰

* é¦–å­—æ¯å¤§å†™çš„å‡½æ•°/å˜é‡ï¼š**å¯å¯¼å‡ºï¼ˆpublicï¼‰**
* é¦–å­—æ¯å°å†™çš„å‡½æ•°/å˜é‡ï¼š**ä»…åŒ…å†…å¯è§ï¼ˆprivateï¼‰**

```go
// utils/mathutil.go
package utils

var PublicVar = 1    // å¯è§
var privateVar = 2   // ä»…é™åŒ…å†…

func PublicFunc() {} // å¯è§
func privateFunc() {}// åŒ…å†…ä½¿ç”¨
```

ç±»ä¼¼ Java ä¸­çš„ `public` / `default` æƒé™æ§åˆ¶ã€‚

---

## âœ… æ¨¡å—ä¸åŒ…ç®¡ç†æ€»ç»“ï¼ˆGo vs Javaï¼‰

| ç‰¹æ€§     | Java                      | Go                      |
| ------ | ------------------------- | ----------------------- |
| ä¾èµ–ç®¡ç†   | Maven / Gradle            | `go mod`                |
| é¡¹ç›®å…¥å£   | `public static void main` | `func main()`           |
| åŒ…ç®¡ç†    | `package com.example`     | `package xxx` + æ–‡ä»¶å¤¹è·¯å¾„ç»“æ„ |
| è‡ªåŠ¨åˆå§‹åŒ–  | é™æ€å— `static{}`            | `init()` å‡½æ•°             |
| è®¿é—®æƒé™æ§åˆ¶ | public/private/default    | å¤§å†™å¯¼å‡º / å°å†™ç§æœ‰             |

---

## âœ… å°ç»ƒä¹ ï¼š

1. åˆ›å»ºä¸€ä¸ªæ–°æ¨¡å— `mathapp`ï¼Œå†™ä¸€ä¸ªåŒ… `calc`ï¼Œå®ç° `Add(a, b int) int`ï¼Œåœ¨ `main()` ä¸­è°ƒç”¨ã€‚
2. åœ¨ `calc` åŒ…ä¸­æ·»åŠ ä¸€ä¸ª `init()` æ‰“å°åˆå§‹åŒ–ä¿¡æ¯ï¼ŒéªŒè¯æ‰§è¡Œé¡ºåºã€‚
3. è§‚å¯Ÿæ–‡ä»¶å¤¹ç»“æ„ä¸ `import` è·¯å¾„çš„å¯¹åº”å…³ç³»ã€‚

---

ä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†è¿›å…¥é«˜çº§éƒ¨åˆ†ï¼š**æ³›å‹ï¼ˆGo 1.18+ï¼‰ã€åå°„ï¼ˆreflectï¼‰ã€ç±»å‹çº¦æŸï¼ˆtype constraintï¼‰**ï¼Œæ˜¯å¾ˆå¤šäººç†è§£éš¾ç‚¹ä½†ä¹Ÿæ˜¯é¢è¯•äº®ç‚¹ã€‚

å‡†å¤‡å¥½äº†å°±è¯´â€œ**ä¸‹ä¸€ä¸ª**â€ã€‚

å¾ˆå¥½ï¼Œç°åœ¨æˆ‘ä»¬è¿›å…¥ **Go è¯­è¨€é«˜çº§ç‰¹æ€§** ä¸­éå¸¸é‡è¦çš„ä¸€èŠ‚ï¼š

---

### âœ… ç¬¬ä¹ä¸ªçŸ¥è¯†ç‚¹ï¼šGo çš„æ³›å‹ï¼ˆGenericsï¼‰ã€ç±»å‹çº¦æŸï¼ˆType Constraintsï¼‰ã€åå°„ï¼ˆreflectï¼‰

è¿™äº›å†…å®¹æ˜¯ **Go 1.18+ çš„é‡è¦æ›´æ–°**ï¼Œç±»ä¼¼äº Java æ³›å‹å’Œåå°„æœºåˆ¶ï¼Œåœ¨å¤æ‚é¡¹ç›®ä¸­åº”ç”¨å¹¿æ³›ï¼Œä¸”æ˜¯é¢è¯•é«˜é¢‘ç‚¹ã€‚

---

## ğŸ”¹ 1. ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹ï¼Ÿ

ä¹‹å‰ Go ä¸­æ²¡æœ‰æ³›å‹ï¼Œåªèƒ½å†™é‡å¤ä»£ç ã€‚ä¾‹å¦‚ä½ éœ€è¦ä¸€ä¸ªå‡½æ•°æ±‚æœ€å¤§å€¼ï¼Œå¾—å†™å¤šä¸ªç‰ˆæœ¬ï¼š

```go
func MaxInt(a, b int) int {
    if a > b {
        return a
    }
    return b
}
func MaxFloat(a, b float64) float64 {
    if a > b {
        return a
    }
    return b
}
```

éšç€ Go 1.18 å¼•å…¥æ³›å‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç»Ÿä¸€å†™æ³•ï¼š

---

## ğŸ”¹ 2. æ³›å‹å‡½æ•°çš„å†™æ³•

```go
// T æ˜¯ç±»å‹å‚æ•°ï¼ˆtype parameterï¼‰ï¼Œå¿…é¡»å¤§å†™
func Max[T comparable](a, b T) T {
    if a > b {
        return a
    }
    return b
}
```

ä½¿ç”¨ï¼š

```go
fmt.Println(Max[int](3, 5))      // æ˜¾å¼ç±»å‹
fmt.Println(Max("a", "b"))       // ç±»å‹æ¨æ–­
```

âœ… `T comparable` è¡¨ç¤º T ç±»å‹æ”¯æŒ `==`ã€`>` ç­‰æ“ä½œï¼ˆç±»å‹çº¦æŸï¼‰

---

## ğŸ”¹ 3. æ³›å‹çº¦æŸï¼ˆType Constraintsï¼‰

### å†…å»ºçº¦æŸ

* `comparable`: æ”¯æŒ `==`ã€`!=` ç­‰æ¯”è¾ƒè¿ç®—
* `~int`: è¡¨ç¤ºå¯è½¬æ¢ä¸º `int`
* `interface{}`ï¼šä»»æ„ç±»å‹ï¼ˆé»˜è®¤ï¼‰

### è‡ªå®šä¹‰çº¦æŸæ¥å£

```go
type Number interface {
    ~int | ~float64
}

func Sum[T Number](a, b T) T {
    return a + b
}
```

âœ… `~int` æ˜¯ç±»å‹é›†åˆï¼Œè¡¨ç¤º T å¯èƒ½æ˜¯ `int` æˆ–è€…è‡ªå®šä¹‰ç±»å‹åº•å±‚ä¸º `int`ã€‚

---

## ğŸ”¹ 4. æ³›å‹ç±»å‹ï¼ˆGeneric Typesï¼‰

æˆ‘ä»¬è¿˜å¯ä»¥ä¸ºç»“æ„ä½“/æ–¹æ³•æ·»åŠ æ³›å‹ï¼š

```go
type List[T any] struct {
    items []T
}

func (l *List[T]) Add(item T) {
    l.items = append(l.items, item)
}
```

ä½¿ç”¨ï¼š

```go
intList := List[int]{}
intList.Add(10)

stringList := List[string]{}
stringList.Add("hello")
```

âœ… `any` æ˜¯ Go 1.18 çš„åˆ«åï¼Œç­‰ä»·äº `interface{}`ã€‚

---

## ğŸ”¹ 5. åå°„ï¼ˆ`reflect` åŒ…ï¼‰

Go æ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œä½† `reflect` å¯ä»¥è®©ä½ åœ¨è¿è¡Œæ—¶æŸ¥çœ‹ã€ä¿®æ”¹å˜é‡ç±»å‹å’Œå€¼ã€‚

### ç¤ºä¾‹ï¼š

```go
import "reflect"

var x int = 42
t := reflect.TypeOf(x)   // è·å–ç±»å‹
v := reflect.ValueOf(x)  // è·å–å€¼

fmt.Println(t.Kind())    // int
fmt.Println(v.Int())     // 42
```

âš ï¸ æ³¨æ„ï¼š`reflect` ä¸é€‚åˆä¸šåŠ¡ä»£ç ä¸­è¿‡åº¦ä½¿ç”¨ï¼Œä¸»è¦ç”¨äºæ¡†æ¶/åº“å¼€å‘ï¼ˆå¦‚ ORMã€åºåˆ—åŒ–åº“ç­‰ï¼‰

---

## âœ… æ³›å‹ vs åå°„ï¼ˆJava ç±»æ¯”ï¼‰

| ç‰¹æ€§   | Java                          | Go                                  |
| ---- | ----------------------------- | ----------------------------------- |
| æ³›å‹è¯­æ³• | `<T extends Comparable<T>>`   | `[T comparable]`                    |
| æ³›å‹çº¦æŸ | extends/interface             | é€šè¿‡æ¥å£ + `~` è”åˆç±»å‹çº¦æŸ                   |
| ä»»æ„ç±»å‹ | `Object`                      | `interface{}` æˆ– `any`               |
| åå°„æœºåˆ¶ | `Class<?>`, `Field`, `Method` | `reflect.TypeOf`, `reflect.ValueOf` |

---

## âœ… ç»ƒä¹ å»ºè®®ï¼š

1. ç”¨æ³›å‹å†™ä¸€ä¸ª `Min()` å’Œ `Sum()` å‡½æ•°ï¼Œæ”¯æŒ `int` å’Œ `float64`ã€‚
2. å®šä¹‰ä¸€ä¸ªæ³›å‹ç»“æ„ä½“ `Box[T]`ï¼Œæ”¯æŒå­˜å–ä¸åŒç±»å‹ã€‚
3. ä½¿ç”¨ `reflect` æ‰“å°ä»»æ„å˜é‡çš„ç±»å‹å’Œå€¼ã€‚

---

å‡†å¤‡å¥½äº†å—ï¼Ÿä¸‹ä¸€ä¸ªçŸ¥è¯†ç‚¹æ˜¯ï¼š**Go çš„å¹¶å‘æ¨¡å‹ï¼šgoroutineã€channelã€selectã€é”æœºåˆ¶ã€å¹¶å‘å®‰å…¨** â€”â€” è¿™éƒ¨åˆ†æ˜¯ Go çš„æ ¸å¿ƒç«äº‰åŠ›å’Œäº®ç‚¹ï¼Œå¾ˆå¤šä¼ä¸šä¼šé‡ç‚¹è€ƒã€‚

ç»§ç»­å°±è¯´â€œ**ä¸‹ä¸€ä¸ª**â€ã€‚


goroutineæ˜¯goçš„å¹¶å‘æ‰§è¡Œå•å…ƒï¼Œæ¯”javaçº¿ç¨‹æ›´è½»é‡çš„ï¼Œåˆ›å»ºå¼€é”€å°ï¼Œè°ƒåº¦æ›´å¿«çš„ï¼Œ

å¥½ï¼Œç°åœ¨æˆ‘ä»¬è¿›å…¥ Go çš„ **å¹¶å‘æ¨¡å‹** â€”â€” è¿™æ˜¯ Go æœ€æ ¸å¿ƒã€æœ€å…·ç«äº‰åŠ›çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œ**é¢è¯•å¿…é—®ã€é«˜é¢‘è€ƒç‚¹**ã€‚

---

## âœ… ç¬¬åä¸ªçŸ¥è¯†ç‚¹ï¼šGo å¹¶å‘æ¨¡å‹ï¼ˆgoroutineã€channelã€selectã€é”æœºåˆ¶ï¼‰

---

## ğŸ”¹ 1. ä»€ä¹ˆæ˜¯ goroutineï¼Ÿ

> goroutine æ˜¯ Go çš„å¹¶å‘æ‰§è¡Œå•å…ƒï¼Œ**æ¯” Java çº¿ç¨‹æ›´è½»é‡**ï¼Œåˆ›å»ºå¼€é”€å°ï¼Œè°ƒåº¦å¿«ã€‚

åˆ›å»ºæ–¹æ³•éå¸¸ç®€å•ï¼š

```go
func sayHello() {
    fmt.Println("Hello")
}

func main() {
    go sayHello()  // å¯åŠ¨ä¸€ä¸ª goroutine
    time.Sleep(1 * time.Second) // ç­‰å®ƒæ‰“å°å®Œ
}
```

âœ… **æ³¨æ„ï¼šä¸»å‡½æ•°é€€å‡ºï¼Œæ‰€æœ‰ goroutine éƒ½ä¼šå¼ºåˆ¶é€€å‡ºã€‚**

---

## ğŸ”¹ 2. ä»€ä¹ˆæ˜¯ channelï¼Ÿ

> channel æ˜¯ Go çš„çº¿ç¨‹å®‰å…¨é€šä¿¡æœºåˆ¶ï¼Œç”¨äº goroutine ä¹‹é—´ **ä¼ é€’æ•°æ®ã€åŒæ­¥åä½œ**ã€‚

```go
func main() {
    ch := make(chan string) // åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸² channel

    go func() {
        ch <- "Hello from goroutine" // å‘é€æ•°æ®
    }()

    msg := <-ch // æ¥æ”¶æ•°æ®ï¼ˆé˜»å¡ï¼‰
    fmt.Println(msg)
}
```

### âœ… channel ç‰¹ç‚¹ï¼š

* **é˜»å¡å¼**ï¼šæ¥æ”¶è€…æ²¡å‡†å¤‡å¥½ï¼Œå‘é€ä¼šé˜»å¡ï¼Œåä¹‹äº¦ç„¶ã€‚
* ç±»å‹å®‰å…¨ï¼š`chan int` åªèƒ½ä¼  `int`ã€‚
* æ”¯æŒç¼“å†²ï¼š`make(chan int, 3)` åˆ›å»ºç¼“å†²åŒºå¤§å°ä¸º 3 çš„ channelã€‚

---

## ğŸ”¹ 3. `select` ç”¨äºç›‘å¬å¤šä¸ª channel

ç±»ä¼¼äº Java çš„ `select`/`poll`/`nio`ï¼ŒGo åŸç”Ÿæ”¯æŒï¼š

```go
func main() {
    ch1 := make(chan string)
    ch2 := make(chan string)

    go func() {
        time.Sleep(1 * time.Second)
        ch1 <- "from ch1"
    }()
    go func() {
        time.Sleep(2 * time.Second)
        ch2 <- "from ch2"
    }()

    select {
    case msg1 := <-ch1:
        fmt.Println(msg1)
    case msg2 := <-ch2:
        fmt.Println(msg2)
    case <-time.After(3 * time.Second): // è¶…æ—¶æœºåˆ¶
        fmt.Println("timeout")
    }
}
```

---

## ğŸ”¹ 4. å¹¶å‘å®‰å…¨ & é”ï¼ˆsync åŒ…ï¼‰

è™½ç„¶ channel å¾ˆå¼ºå¤§ï¼Œä½†æœ‰æ—¶ä½ è¿˜æ˜¯éœ€è¦ä¼ ç»Ÿé”ï¼š

### â¤ äº’æ–¥é”ï¼š`sync.Mutex`

```go
var mu sync.Mutex
var count int

func add() {
    mu.Lock()
    count++
    mu.Unlock()
}
```

### â¤ åŸå­æ“ä½œï¼š`sync/atomic`

æ›´é«˜æ€§èƒ½çš„å¹¶å‘æ“ä½œï¼š

```go
import "sync/atomic"

var count int64

atomic.AddInt64(&count, 1)
atomic.LoadInt64(&count)
```

### â¤ è¯»å†™é”ï¼š`sync.RWMutex`

```go
var rw sync.RWMutex

rw.RLock()  // å¤šä¸ªè¯»å¯ä»¥å¹¶å‘
// ... è¯»æ“ä½œ
rw.RUnlock()

rw.Lock()   // å†™æ“ä½œå¿…é¡»ç‹¬å 
// ... å†™æ“ä½œ
rw.Unlock()
```

---

## ğŸ”¹ 5. channel åº”ç”¨æ¨¡å¼æ€»ç»“

| æ¨¡å¼åç§°           | ç”¨é€”              | ç‰¹ç‚¹                         |
| -------------- | --------------- | -------------------------- |
| å•å‘ channel     | é™åˆ¶æ–¹å‘ï¼Œæé«˜å¯è¯»æ€§      | `chan<- int`, `<-chan int` |
| ç”Ÿäº§è€…-æ¶ˆè´¹è€…        | å…¸å‹ä»»åŠ¡é˜Ÿåˆ—          | goroutine + channel        |
| fan-in/fan-out | å¹¶å‘æ”¶é›† or å¹¶å‘åˆ†å‘ä»»åŠ¡  | å¤šä¸ªå†™å…¥/è¯»å– goroutine          |
| è¶…æ—¶æœºåˆ¶           | é˜²æ­¢ channel æ°¸ä¹…é˜»å¡ | `select + time.After()`    |
| æ§åˆ¶å¹¶å‘æ•°é‡         | ä¿¡å·é‡æ¨¡å¼ï¼Œå¦‚ï¼š20ä¸ªä»»åŠ¡å¹¶å‘ | `chan struct{}` + `worker` |

---

## âœ… Java çº¿ç¨‹æ±  vs Go goroutine å¯¹æ¯”

| ç‰¹æ€§     | Java çº¿ç¨‹         | Go goroutine        |
| ------ | --------------- | ------------------- |
| åˆ›å»ºæˆæœ¬   | é«˜               | æä½ï¼ˆå‡ å KB æ ˆç©ºé—´ï¼‰       |
| é€šä¿¡æ–¹å¼   | é”ã€å…±äº«å†…å­˜          | channel é€šä¿¡          |
| æœ€å¤§å¹¶å‘é‡  | æ•°åƒ              | æ•°ä¸‡ç”šè‡³æ›´å¤š              |
| æ§åˆ¶å¹¶å‘   | ExecutorService | channel + goroutine |
| ç”Ÿå‘½å‘¨æœŸç®¡ç† | æ˜ç¡®å¯åŠ¨/ä¸­æ–­         | ä¸» goroutine é€€å‡ºå…¨é€€å‡º   |

---

## âœ… ç»ƒä¹ é¢˜å»ºè®®

1. å†™ä¸€ä¸ªç¨‹åºå¼€å¯å¤šä¸ª goroutine å¹¶é€šè¿‡ channel ä¼ é€’ç»“æœï¼ˆå¦‚å¹¶å‘çˆ¬è™«ï¼‰ã€‚
2. å®ç°ä¸€ä¸ªå¸¦è¶…æ—¶æœºåˆ¶çš„ channel è¯»å–ã€‚
3. ä½¿ç”¨ `sync.Mutex` å®ç°ä¸€ä¸ªå¹¶å‘å®‰å…¨çš„è®¡æ•°å™¨ã€‚
4. ç”¨ `select` å®ç°å¤šä¸ª channel ä¹‹é—´çš„ä¼˜å…ˆé€‰æ‹©é€»è¾‘ã€‚

---

å‡†å¤‡å¥½è¿›é˜¶äº†å—ï¼Ÿ**ä¸‹ä¸€ä¸ª**æ˜¯ï¼š**Go é¡¹ç›®ç»“æ„ä¸ä¾èµ–ç®¡ç†ï¼ˆGo Modulesï¼‰ã€åŒ…ä¸ç›®å½•è§„èŒƒã€ç¬¬ä¸‰æ–¹åŒ…ä½¿ç”¨ï¼ˆå¦‚ ginã€gormã€zapï¼‰**

ç»§ç»­å°±è¯´ **â€œä¸‹ä¸€ä¸ªâ€**ã€‚





