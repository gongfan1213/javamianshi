# Loomi 多Agent系统提示词格式分析

## 系统概述
基于完整执行日志的Agent提示词格式分析，包含Concierge、Orchestrator和各种Action的详细格式。

---

## 1. Concierge Agent 的 User Prompt

### 完整对话上下文
```
[chat_history]
#1 **用户**: 帮我写一篇小红书
#2 Loomi（你）: 您好，很高兴为您服务！我是Loomi，您的专属内容管家。
#3 **用户**: 个人生活，快速涨粉
#4 Loomi（你）: 明白了！您希望创作个人生活类的小红书内容，目标是快速涨粉。为了给您提供更精准的内容策略，我需要了解一些细节：

1. **您的账号人设定位**：比如是都市白领、大学生、宝妈、创业者等？
2. **您的内容风格偏好**：是走温馨治愈路线，还是搞笑吐槽，或者是干货分享？
3. **您的目标受众**：主要想吸引哪类人群关注？
4. **您有什么特别的生活经历或技能**：比如有趣的工作经历、爱好特长、生活感悟等，这些都可以成为内容素材。

既然方向有了，那我们就可以开始构思具体的内容了。您是希望我们围绕某个特定的话题来创作，还是由我们来为您主导选题策划？
#5 **用户**: 开始吧，我想做个人生活类的

[任务执行时间线]
系统状态: Orchestrator未启动，等待任务需求传递
```

### 特点分析
- **格式**: `[chat_history]` + `[任务执行时间线]`
- **内容**: 完整的对话历史记录，包含用户和Loomi的交互
- **状态**: 显示Orchestrator的启动状态
- **作用**: 为后续任务传递提供完整的上下文

---

## 2. Orchestrator Agent 的 User Prompt

### Round 1 - 初始任务接收
```
[任务执行时间线]
**用户消息与反馈**1:
用户需要为小红书个人生活类账号生产内容，核心目标是快速涨粉。用户没有提供具体的话题方向，希望我们来主导策划选题和内容。
```

### Round 2 - 开始ReAct循环
```
[任务执行时间线]
**用户消息与反馈**1:
用户需要为小红书个人生活类账号生产内容，核心目标是快速涨粉。用户没有提供具体的话题方向，希望我们来主导策划选题和内容。
  └─ Round1: executed profile. memo: 快速涨粉需要一个清晰且有吸引力的人设。我将首先探索几种可能在小红书上快速起势的用户画像，分析他们的特点、欲望和潜在痛点，为后续的选题策划提供精准的目标。

[created_notes]
@profile1:
家境优渥的艺术类女大学生，热衷分享不带logo的松弛感日常，潜意识中既想展现"不经意的阶级"，又害怕被贴上"不学无术"的标签。

@profile2:
从大厂裸辞回老家的95后青年，记录返乡后低物欲的"躺平"生活，看似在逃离内卷，实则在对抗"失败者"的自我审判和外界眼光。

@profile3:
在县城开小店的年轻创业者，用"逆袭"叙事包装平凡生活，渴望通过"小镇青年也能成功"的故事获得认同和流量。
```

### Round 3-6 - 持续累积的上下文
```
[任务执行时间线]
**用户消息与反馈**1:
用户需要为小红书个人生活类账号生产内容，核心目标是快速涨粉。用户没有提供具体的话题方向，希望我们来主导策划选题和内容。
  └─ Round1: executed profile. memo: 快速涨粉需要一个清晰且有吸引力的人设...
  └─ Round2: executed insight. memo: 我已经明确了三个人设方向...
  └─ Round3: executed xhs_post. memo: 基于@profile2的人设，我创作了两篇内容...
  └─ Round4: executed content_analysis. memo: 我需要深入分析这些内容的成功要素...
  └─ Round5: executed content_analysis. memo: 我已成功提炼出爆款公式...
  └─ Round6: executed hitpoint. memo: 基于公式生成具体选题库...

[created_notes]
@profile1: 家境优渥的艺术类女大学生，热衷分享不带logo的松弛感日常...
@profile2: 从大厂裸辞回老家的95后青年，记录返乡后低物欲的"躺平"生活...
@profile3: 在县城开小店的年轻创业者，用"逆袭"叙事包装平凡生活...
@insight1: 当下小红书个人生活类的核心流量密码在于"反差感+共鸣点+价值升华"...
@xhs_post1: 从月薪3w到3k，我在菜市场找到了久违的快乐...
@xhs_post2: 辞职后的第30天，我终于理解了妈妈的唠叨...
@content_analysis1: 这两篇帖子的成功在于精准捕捉了当下年轻人的核心情绪...
@content_analysis2: 从内容策略上看，这两篇帖子成功运用了"反向叙事"与"细节共鸣"...
@content_analysis3: 其可复制的选题公式可以总结为：**（过去的高压符号 + 现在的松弛场景）+ 反差感标题 + 亲情/自我和解的价值升华**...
@hitpoint4: 我把大厂汇报的PPT功夫，用在了给爸妈分析菜市场最优买菜路线...
@hitpoint5: 以前陪客户的酒局我唯唯诺诺，现在陪我爸钓鱼我重拳出击...
@hitpoint6: 翻出了当年面试大厂穿的战袍，现在穿着它去赶集...
```

### 特点分析
- **格式**: `[任务执行时间线]` + `[created_notes]`
- **累积性**: 每轮都包含之前所有轮次的memo和notes
- **结构化**: 清晰的树状结构展示执行历史
- **引用系统**: 通过@note_id实现跨轮次引用

---

## 3. Action Agent 的 User Prompt

### 3.1 思考类Action格式

#### profile Action 示例
```
[任务指令]
为小红书个人生活类账号快速涨粉，分析可能的人设定位

[引用内容]
（此轮无引用内容）
```

#### insight Action 示例
```
[任务指令]
基于@profile1、@profile2、@profile3三个人设，深入分析小红书个人生活类内容的流量规律

[引用内容]
@profile1:
家境优渥的艺术类女大学生，热衷分享不带logo的松弛感日常，潜意识中既想展现"不经意的阶级"，又害怕被贴上"不学无术"的标签。

@profile2:
从大厂裸辞回老家的95后青年，记录返乡后低物欲的"躺平"生活，看似在逃离内卷，实则在对抗"失败者"的自我审判和外界眼光。

@profile3:
在县城开小店的年轻创业者，用"逆袭"叙事包装平凡生活，渴望通过"小镇青年也能成功"的故事获得认同和流量。
```

#### hitpoint Action 示例
```
[任务指令]
基于爆款公式@content_analysis3，为@profile2人设生成一批新的选题

[引用内容]
@content_analysis3:
其可复制的选题公式可以总结为：**（过去的高压符号 + 现在的松弛场景）+ 反差感标题 + 亲情/自我和解的价值升华**。具体操作上，首先选择一个代表过去高压状态的符号，如"大厂KPI"、"百万饭局"；然后用一个充满烟火气的当下场景进行对撞，如"老家早市"、"和妈妈买菜"。标题要直接点明这种身份或状态的巨大反差，如《从月薪3w到3k》。最后，在结尾处将这种选择升华到"找回自我"、"放过自己"或"亲情的珍贵"这类能引发普遍情感共鸣的价值层面，从而完成从个人记录到群体情绪表达的转化，引爆传播。

@profile2:
从大厂裸辞回老家的95后青年，记录返乡后低物欲的"躺平"生活，看似在逃离内卷，实则在对抗"失败者"的自我审判和外界眼光。
```

### 3.2 写作类Action格式

#### xhs_post Action 示例
```
[任务指令]
基于@profile2的人设，结合@insight1的流量洞察，创作2篇小红书帖子

[引用内容]
@profile2:
从大厂裸辞回老家的95后青年，记录返乡后低物欲的"躺平"生活，看似在逃离内卷，实则在对抗"失败者"的自我审判和外界眼光。

@insight1:
当下小红书个人生活类的核心流量密码在于"反差感+共鸣点+价值升华"的组合。反差感来自于身份、状态、场景的巨大对比；共鸣点要精准击中目标用户的痛点或欲望；价值升华则是将个人经历上升到普遍的人生哲理层面，让用户产生"这不就是我吗"的强烈代入感。
```

#### content_analysis Action 示例
```
[任务指令]
深入分析@xhs_post1和@xhs_post2的内容策略，提炼可复制的爆款公式

[引用内容]
@xhs_post1:
从月薪3w到3k，我在菜市场找到了久违的快乐

昨天去菜市场，看到一个阿姨为了几毛钱跟摊主唇枪舌战，我突然笑了。

三个月前，我还在会议室里为了一个数据跟同事争论到脸红脖子粗，现在却觉得阿姨的较真格外可爱。

@xhs_post2:
辞职后的第30天，我终于理解了妈妈的唠叨

"这菜你看，顶上还挂着露水，肯定新鲜。"

妈妈边说边挑着青菜，动作轻柔得像在抚摸什么珍贵的东西。

以前我总嫌她买菜慢，现在才明白，她不是在买菜，她是在用心生活。
```

---

## 4. 执行流程总结

### 4.1 系统架构
```
用户输入 → Concierge理解需求 → Orchestrator执行ReAct循环 → 各种Action产出内容
```

### 4.2 ReAct循环模式
1. **观察** (Observe) - 分析当前状态和已有notes
2. **思考** (Think) - 制定下一步策略
3. **行动** (Act) - 执行具体的action
4. **累积** (Accumulate) - 将结果保存为notes，供后续引用

### 4.3 Action分类
- **思考类**: profile, insight, hitpoint, brand_analysis
- **写作类**: xhs_post, wechat_article, tiktok_script
- **分析类**: content_analysis

### 4.4 Notes引用系统
- **格式**: `@note_id`
- **作用**: 跨轮次、跨action的信息传递
- **特点**: 支持多个notes的组合引用

---

## 5. 关键发现

### 5.1 设计优势
1. **极简用户提示词**: 只有`[任务指令]`+`[引用内容]`，清晰简洁
2. **强大的上下文累积**: 每轮都包含完整的执行历史
3. **灵活的引用系统**: 支持精准的跨轮次信息传递
4. **模块化设计**: 各Action独立但可协同工作

### 5.2 系统限制
1. **轮次限制**: 最多6轮执行（此次实际执行）
2. **单轮单Action**: 每轮只能执行一个action
3. **上下文膨胀**: 随着轮次增加，上下文会越来越长
4. **Token消耗**: 大量thinking tokens的使用

### 5.3 性能数据
- **LLM调用次数**: 15次
- **输入Token**: 19,222
- **输出Token**: 5,071  
- **思考Token**: 5,724
- **总费用**: $0.1320

---

## 6. 结论

Loomi系统通过精心设计的提示词格式和ReAct循环机制，实现了从需求理解到内容生产的完整闭环。其核心优势在于：

1. **结构化的信息传递**: 通过标准化的格式确保信息准确传递
2. **累积式的知识构建**: 每轮执行都在前一轮基础上深化
3. **模块化的功能设计**: 各Agent职责明确，协同高效
4. **智能的内容生产**: 从分析到创作，形成完整的生产链路

这种设计使得系统能够处理复杂的创作任务，从模糊的用户需求最终产出高质量的社媒内容。 
