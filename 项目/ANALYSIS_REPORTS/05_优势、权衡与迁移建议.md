### 优势、权衡与迁移建议

#### dev（LangGraph+LangChain+Langfuse）优势
- 编排可视：DAG/状态清晰，节点/边/条件路由一目了然；
- 可恢复：Memory/Redis 检查点 + 人审中断/恢复，长链路健壮；
- 易扩展：`@tool` + `create_react_agent` 工具注入，新增能力最小改动面；
- 可观测：Langfuse 会话级追踪统一 `/chat` 与 `/graph_v2`；
- 代码解耦：编排/工具层收敛，业务与基础设施分离，便于测试与替换。

#### 潜在成本
- 学习曲线：StateGraph/检查点/中断语义需要团队熟悉；
- 运行复杂度：需要运维 Redis/观测栈与 ttl 管理；
- 框架绑定：需关注 langgraph/langchain 版本兼容与 API 变化。

#### prod（传统流程 + LangSmith）现状优势
- 路线稳定：已有生产实战验证与日志/队列体系；
- 团队熟悉：成熟的 Nova3/Loomi 组织方式与 LangSmith 追踪链路。

#### 迁移建议
- 渐进改造：从非关键路径开始，将 prod 中部分 agent 能力封装为 `@tool` 并由局部子图编排；
- 观测并存：保留 LangSmith 的同时，在 dev 线引入 Langfuse，验证指标口径一致性；
- 数据对齐：统一 `thread_id=user_id:session_id` 与消息历史合并策略，便于跨接口关联；
- 基线测试：为 `/graph_v2/chat/stream` 建立 E2E 校验（阶段事件、最终结果、人审恢复）。


