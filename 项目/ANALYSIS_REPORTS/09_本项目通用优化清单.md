### 本项目通用优化清单（迭代产出）

#### 编排与恢复
- 基于 `StateGraph` 的三阶段 DAG，节点/边/条件路由显式；
- 检查点：`MemorySaver` 与 `AsyncRedisSaver`，会话标识统一为 `thread_id=user_id:session_id`；
- 中断/恢复：结合人审场景，流式中断后通过 `/graph/resume` 继续。

#### API 与事件
- `/graph_v2/chat/stream` 提供阶段/节点事件、最终结果；
- SSE 输出结构稳定，便于前端实时渲染与调试；
- 统一追踪：每次图执行创建/结束会话级 trace（Langfuse）。

#### 工具与 Agent
- `@tool` + `create_react_agent` 统一工具注入；
- 将复杂逻辑拆分为可复用工具函数，降低耦合；
- 便于引入外部 API/检索/向量库等能力。

#### 性能与稳态
- 限流中间件与告警（Redis 配置驱动）；
- 递归深度与 astream 配置，防止无界递归；
- Redis TTL 管控与 SCAN 替代 KEYS，避免阻塞。

#### 可观测与规范
- 从 LangSmith 向 Langfuse 迁移，统一会话追踪口径；
- 结构化日志、关键阶段事件埋点；
- 状态模型（TypedDict）标准化，便于跨层协作与 QA。


